import{k as s}from"./index-SyIWf7Eq.js";import{l as C,r as P}from"./index-SyIWf7Eq.js";const v={onInit(t,e){e.render()},onclick(t,e){e.classList.contains("border-green-700")?(e.classList.remove("border-green-700"),e.classList.add("border-red-700")):(e.classList.remove("border-red-700"),e.classList.add("border-green-700"))},render(t,e){}},S={onClick(t,e,n){n.preventDefault();const r=e.getAttribute("href");window.history.pushState({},"",r),s.injectPage(r)}},x={onInit(t,e){e.render()},render(t,e){s.plugins.translate(e)}},E={onInit(t,e){e.render()},render(t,e){s.plugins.translate(e)}};let c;const m=new Uint8Array(16);function y(){if(!c&&(c=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!c))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(m)}const o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function b(t,e=0){return o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]}const w=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),u={randomUUID:w};function h(t,e,n){if(u.randomUUID&&!e&&!t)return u.randomUUID();t=t||{};const r=t.random||(t.rng||y)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let a=0;a<16;++a)e[n+a]=r[a];return e}return b(r)}const g="rc__userId";function _(){const t=localStorage.getItem(g);if(t)return t;const e=h();return localStorage.setItem(g,e),e}function U(){const{params:t}=s.parseRoute(),e={"X-USER-ID":_()};return t.editor&&(e["X-editor-ID"]=t.broadcast),t.viewer&&(e["X-viewer-ID"]=t.broadcast),{headers:e}}async function i(t,e,n,r){const a=U();return await fetch(n,{method:t,signal:e,body:r,...a})}const p={async get(t,e){return await i("GET",e,t)},async post(t,e,n){return await i("POST",e,t,n)},async put(t,e,n){return await i("PUT",e,t,n)},async delete(t,e){return await i("DELETE",e,t)}},j={state:{isInit:!1,controller:new AbortController,broadcast:[]},async onInit(t){if(console.log("lastBroadcast onInit"),t.isInit)return;t.isInit=!0;const e=t.controller.signal;try{const r=await(await p.get("/api/broadcasts/last",e)).json();t.broadcast=r,console.log(r)}catch(n){console.log(n)}},onClean(t){t.controller.abort()},render(){}},L={state:{error:"",controller:new AbortController},onInit(t,e){s.plugins.translate(e),e.render()},async onSubmit(t,e,n){n.preventDefault();const r=new FormData(e),a=Object.fromEntries(r.entries());try{const l=await p.post("/api/broadcast",t.controller.signal,a),{editor:I}=await l.json(),d=`/bc/editor/${I}`;window.history.pushState(null,null,d),s.injectPage(d)}catch(l){console.log("broadcast creation: ",l),t.error="error_create_broadcast"}},onClean(t){t.controller.abort()},render(){}},R={render(t,e,n){if(!n.key)return;const{value:r}=n;e.innerText!==r&&e.setAttribute("data-trans",r),s.plugins.translate(e)}},k={state:{value:"",error:""},onInput(t,e,n){t.value=n.target.value,t.error=""},render(){}};export{v as button,L as createBroadcastForm,R as errorMsg,E as header,k as input,j as lastBroadcast,S as link,C as lsKEY,P as rupteur,x as translate};
